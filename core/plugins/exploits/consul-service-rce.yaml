app: Consul by HashiCorp
query: title:"consul"
meta:
  name: consul-service-rce
  level: 4
  tags:
    - remote_code_execution
  description: Consul 在特定配置下可能导致 RCE 漏洞
  homepage: https://www.consul.io/
  author: 一曲成殇
  references: https://www.exploit-db.com/exploits/46074
  solution: |-
    禁用Consul服务器上的脚本检查
    确保ConsulHTTP API 不可外网访问
    如果尚未启用ACL，则启用 ACL
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /v1/agent/self
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: body
              value: "\"EnableRemoteScriptChecks\": true"
              type: contains
            - name: code
              value: "200"
              type: equals
  create_at: "2021-11-06 21:21:06"
