app: 用友软件
query: app:"用友软件"
meta:
  name: 用友NC BeanShell远程代码执行漏洞
  level: 4
  tags:
    - remote_code_execution
  description: 用友NC是面向集团企业的管理软件，其在同类市场占有率中达到亚太第一。该漏洞是由于用友NC对外开放了BeanShell接口，攻击者可以在未授权的情况下直接访问该接口，并构造恶意数据执行任意代码并获取服务器权限。
  homepage: http://www.yonyou.com/
  author: 一曲成殇
  references: https://blog.csdn.net/aixioxiaoxaio/article/details/117662726
  solution: 更新补丁、设置接口访问策略
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /servlet/~ic/bsh.servlet.BshServlet
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: print("hello!");
              type: contains
  create_at: "2021-11-23 17:51:18"
