app: CouchCMS
query: body:"CouchCMS"
meta:
  name: couchcms-cve-2018-7662
  level: 4
  tags:
    - path_traversal
  description: Couch through 2.0 allows remote attackers to discover the full path
    via a direct request to includes/mysql2i/mysql2i.func.php or addons/phpmailer/phpmailer.php.
  homepage: http://couchcms.com/
  author: 一曲成殇
  references: https://github.com/CouchCMS/CouchCMS/issues/46
  solution: update app
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: POST
            path: /includes/mysql2i/mysql2i.func.php
            redirect: true
            header: [ ]
            params: ""
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: mysql
              type: contains
        - request:
            method: POST
            path: /addons/phpmailer/phpmailer.php
            redirect: true
            header: [ ]
            params: ""
          response:
            - name: body
              value: add_event_listener
              type: contains
            - name: code
              value: "200"
              type: equals
  create_at: "2021-11-06 21:29:55"
