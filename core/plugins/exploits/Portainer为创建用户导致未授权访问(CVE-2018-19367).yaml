app: Portainer
query: title:"Portainer"
meta:
  name: Portainer为创建用户导致未授权访问(CVE-2018-19367)
  level: 4
  tags:
    - ultra_vires
  description: Portainer是一款用于管理Docker环境和Docker主机的轻量级用户管理界面。 Portainer 1.19.2及之前版本中存在安全漏洞，该漏洞源于在管理员未被创建时，用于验证的API端点会返回404，而管理员已被创建时，则会返回204。攻击者可利用该漏洞在主机上获取未授权的访问权限。
  homepage: https://portainer.io/
  author: Administrator
  references: https://github.com/lichti/shodan-portainer/
  solution: 升级至新版本
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /api/users/admin/check
            redirect: true
            header: [ ]
            params: ""
          response:
            - name: code
              value: "404"
              type: equals
  create_at: "2022-05-23 11:00:29"
