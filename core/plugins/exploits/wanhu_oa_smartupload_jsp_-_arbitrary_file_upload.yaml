app: ezoffice
query: app:"ezoffice"
meta:
  name: Wanhu OA smartUpload.jsp - Arbitrary File Upload
  level: 4
  tags:
  - file_upload
  description: Wanhu OA smartUpload.jsp file has a file upload interface and does
    not filter file types, resulting in arbitrary file upload vulnerabilities. Malicious
    JSP files can be uploaded directly.
  homepage: ""
  author: X prism
  references: ""
  solution: Upload to new version
  create_at: "2024-07-13 13:18:41"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: GET
          path: /defaultroot/extension/smartUpload.jsp?path=information&fileName=infoPicName&saveName=infoPicSaveName&tableName=infoPicTable&fileMaxSize=0&fileMaxNum=0&fileType=gif,jpg,bmp,jsp,png&fileMinWidth=0&fileMinHeight=0&fileMaxWidth=0&fileMaxHeight=0
          redirect: true
          header: []
          params: ""
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: 上传
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
