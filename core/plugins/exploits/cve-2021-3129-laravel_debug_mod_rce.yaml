app: Laravel
query: app:"Laravel"
meta:
  name: CVE-2021-3129-Laravel_debug_mod_rce
  level: 4
  tags:
  - remote_code_execution
  description: |-
    当Laravel开启了Debug模式时，由于Laravel自带的Ignition
    组件对file_get_contents()和file_put_contents()函数的不安全使用，攻击者可以通过发起恶意请求，构造恶意Log文件等方式触发Phar反序列化，最终造成远程代码执行。
  homepage: https://laravel.com/
  author: X prism
  references: ""
  solution: 升级至最新版
  create_at: "2024-07-13 00:22:11"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /_ignition/execute-solution
          redirect: true
          header:
          - Content-Type: application/json
          params: |-
            {
                "solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
                "parameters": {
                    "variableName": "sxv",
                    "viewFile": "asdfasdf"
                }
            }
        response:
        - name: code
          value: "500"
          type: equals
        - name: body
          value: '"file_get_contents('
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
