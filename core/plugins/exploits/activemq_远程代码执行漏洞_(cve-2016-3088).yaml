app: ActiveMQ
query: app:"activemq"
meta:
  name: ActiveMQ 远程代码执行漏洞 (CVE-2016-3088)
  level: 3
  tags:
    - remote_code_execution
  description: |-
    ActiveMQ 是 Apache 软件基金会下的一个开源消息驱动中间件软件。Jetty 是一个开源的 servlet 容器，它为基于 Java 的 web 容器，例如 JSP 和 servlet 提供运行环境。ActiveMQ 5.0 及以后版本默认集成了jetty。在启动后提供一个监控 ActiveMQ 的 Web 应用。
    2016年4月14日，国外安全研究人员 Simon Zuckerbraun 曝光 Apache ActiveMQ Fileserver 存在多个安全漏洞，可使远程攻击者用恶意代码替代Web应用，在受影响系统上执行远程代码（CVE-2016-3088）。
  homepage: https://github.com/apache/activemq
  author: Administrator
  references: https://blog.csdn.net/qq_37113223/article/details/114853658
  solution: ActiveMQ Fileserver的功能在5.14.0及其以后的版本中已被移除。建议用户升级至 5.14.0 及其以后版本。
  steps:
    variable:
      - filename: randomLowercase(6)
      - fileContent: ' randomLowercase(6)'
    verify_steps:
      type: or
      verify:
        - request:
            method: PUT
            path: /fileserver/{{filename}}.txt
            redirect: true
            header: [ ]
            params: '{{fileContent}}'
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: home
              type: contains
        - request:
            method: GET
            path: /admin/test/index.jsp
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: code
              value: "200"
              type: equals
            - name: body
              value: home
              type: contains
  create_at: "2022-05-26 11:13:15"
