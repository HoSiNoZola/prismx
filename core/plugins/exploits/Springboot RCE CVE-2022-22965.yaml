app: Spring
query: app:"Java"
meta:
  name: Springboot RCE CVE-2022-22965
  level: 5
  tags:
    - remote_code_execution
  description: 在 JDK 9 及以上版本环境下，可以利用此漏洞在未授权的情况下在目标系统上写入恶意程序从而远程执行任意代码。
  homepage: https://spring.io/guides/gs/spring-boot/
  author: 一曲成殇
  references: https://blog.csdn.net/god_zzZ/article/details/124029497
  solution: 安装官方补丁、升级至安全版本
  steps:
    verify_steps:
      type: or
      verify:
        - request:
            method: GET
            path: /?class.module.classLoader%5b1%5d=1
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: code
              value: "500"
              type: equals
            - name: body
              type: contains
              value: "Invalid property &#39;class.module.classLoader[1]&#39; of bean class [java.lang.Class]: Property referenced in indexed property path &#39;classLoader[1]&#39; is neither an array nor a List nor a Map; returned value was [ParallelWebappClassLoader"
        - request:
            method: GET
            path: /?class.module.classLoader=1
            redirect: false
            header: [ ]
            params: ""
          response:
            - name: code
              value: "500"
              type: equals
            - name: body
              type: contains
              value: "Invalid property &#39;class.module.classLoader[1]&#39; of bean class [java.lang.Class]: Property referenced in indexed property path &#39;classLoader[1]&#39; is neither an array nor a List nor a Map; returned value was [ParallelWebappClassLoader"
  create_at: "2022-04-27 15:11:45"
